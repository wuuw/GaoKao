<!-- 总页数大于1则显示页码 -->
{% if totalPages > 1 %}
<nav aria-label="Page navigation example">
  <ul class="pagination justify-content-center">
    <li class="page-item {%if page == 1%}disabled{%endif%}">
      <a class="page-link" tabindex="-1"> < </a>
    </li>
    {% for i in range(1, totalPages + 1) -%}
    <li class="page-item {% if i == query.page %}active{%endif%}">
      <a class="page-link">{{i}}</a>
    </li>
    {%- endfor %}
    <li class="page-item {%if page == totalPages%}disabled{%endif%}">
      <a class="page-link"> > </a>
    </li>
  </ul>
</nav>
{%endif%}

<script type="text/javascript">
  "use strict";
  //找到page 部分并删除
  let urlArray = window.location.href.split('&');
  urlArray.forEach((str, index) => {
    if(str.indexOf('page') >= 0) {
      urlArray.splice(index, 1);
    }
  });
  //删除page后的链接
  let urlWithoutPage = urlArray.join('&');

  //绑定click事件
  let lists = $(".pagination li");
  lists.each(function(index) {
    //上一页
    if (index === 0) {
      $(this).one('click', function() {
        window.location.href = urlWithoutPage + "&page=" + {{page - 1}};
      });
    } else if (index === lists.length - 1) {
      $(this).one('click', function() {
        window.location.href = urlWithoutPage + "&page=" + {{page + 1}};
      });
    } else {
      $(this).one('click', function() {
        window.location.href = urlWithoutPage + "&page=" + index;
      })
    }
  });
</script>
